@inject UserManager<User> UserManager

@{
    var user = await UserManager.GetUserAsync(User);
    
}


<environment names="Staging,Production">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HHFYPG8RDG" asp-add-nonce="true"></script>
<script script asp-add-nonce="true">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HHFYPG8RDG');
</script>
</environment>

@if (user != null)
{
    <script asp-add-nonce="true">
        gtag('set', { 'user_id': '@user.Id.GetSHA256Hash()' }); // Set the user ID using signed-in user_id.
    </script>
}

<script asp-add-nonce="true">
    window.addEventListener('error',
        function (event) {
            gtag('event', 'exception', {
                description: event.message + '| URL: ' + document.location.href + '| File: ' + event.source + '| Line: ' + event.lineno,
                fatal: true
            });
        });
</script>
